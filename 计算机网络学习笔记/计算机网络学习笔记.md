# 第一章 计算机网络和因特网

## 电路交换

电路交换: 传统的电路交换要求每个主机之间必须直接连接, 假设网络中有 $n$ 台主机, 就必须使用 $C_n^2$ 条链路, 十分浪费资源. 为了改进, 引入交换机, 让主机连入到交换机上, 通过交换技术实现两台主机的连接.

主机连接到交换机速率远远小于两个交换机之间的速率, 为了提高两个交换机之间链路的利用率, 引入多路复用技术, 实现多个主机同时连接到一个交换机上.
多路复用: 将网络资源划分为资源片, 将资源片分配给各路称之为 calls. 每个 call 独占资源片进行通信. 典型的多路复用技术: 频分多路复用, 时分多路复用, 波分多路复用, 码分多路复用.

- 频分多路复用: 每个用户占用不同的宽带频率, 单位Hz. 用户得到一定的频率之后通信过程中始终占用该频率.
- 时分多路复用TDM: 将时间段划分为等长的时分复用帧, 每个用户占用固定序号的时隙. 各用户占用的时隙是周期性出现的.
- 波分多路复用WDM: 将不同的波长分配给不同的用户, 在光通信系统中常见.
- 码分复用CDM: 多用于无线通信网络, 为每个用户分配一个m比特的唯一码片序列. 用户使用相同频率的载波, 利用各自的码片序列编码数据. 编码信号=原始数据*码片序列. 对于一个用户, 他想要发送它的数据, 那么假如该数据是 0 , 则发送自己的 m比特的码片序列. 如果数据是 1, 就发送 m比特码片序列的补码.并且要求个用户的码片序列相互正交.

## 报文交换

报文: 应用(源)发送信息整体.

## 分组交换

每个ISP本身就是有多台分组交换机和多段通信链路组成的网络.  
IP协议定义了在路由器和端系统之间发送和接收的分组格式.  
Socket interface 规定了运行在一个端系统上的程序请求因特网基础设施向运行在另外一个端系统上的特定目的地程序交换数据的方式.  
在源和目的地之间, 每个分组都通过通信链路和分组交换机传送.  
交换机分为两种: 路由器和链路层交换机.  

分组: 报文拆分出来的一系列较小的数据包, 分组需要报文的拆分与重组, 会产生额外的开销.  
分组交换采用统计多路复用.  
分组交换的交换的特点:

- 存储转发传输: 与报文交换机能够开始向输出链路传输该分组的第一个比特之前, 必须接收到整个分组. 仅当路由器接收到所有分组之后才能向链路传输该分组. 通过 $N$ 条速率均为 $R$ 的链路组成的路径, 从源到目的地发送一个分组, 端到端的时延是 $d_{端到端}==N*L/R$
- 排队时延与分组丢失: 对于每条相连的链路, 该分组交换机有一个输出缓存(输出队列), 用于存储路由器准备发往那条链路的分组.  因此分组需要承受输出缓存的排队时延.
- 转发表和路由选择协议: 当源主机要向目的地端系统发送一个分组时, 源在该分组的首部包含了目的地的IP地址. 路由器有一个转发表, 用于将目的地址映射为输出链路, 路由器会根据分组的地址在转发表里面查找对应的输出链路.

分组交换与报文交换都是采用存储-转发交换方式. 报文交换以完整报文进行 "存储-转发", 分组交换以较小的分组进行 "存储-转发".  
![分组交换](计算机网络学习笔记.assets/2020-11-16-16-27-51.png)  

**报文交换与分组交换的区别:**  
![区别](计算机网络学习笔记.assets/2020-11-16-16-31-12.png)  
![报文交换](计算机网络学习笔记.assets/2020-11-16-16-32-59.png)  
缓存大小至少要 7.5 mb.  
![分组交换](计算机网络学习笔记.assets/2020-11-16-16-36-35.png)  
分组交换远远优越于报文交换.  

分组交换的报文交付时间:  
![分组交换报文交付时间](计算机网络学习笔记.assets/2020-11-16-16-39-30.png)  

**分组交换与电路交换**
![分组交换](计算机网络学习笔记.assets/2020-11-16-16-55-02.png)  

1. 分组交换更适合于突发式的数据网络传输.
   - 资源充分共享
   - 简单,无需呼叫建立
2. 可能产生拥塞现象: 分组延迟和丢失
   - 需要协议处理可靠数据传输和拥塞控制

## 计算机网络性能

速率: 单位时间内传输比特量, b/s, kb/s, Mb/s  
带宽: 原来指信号具有的频带宽度, 及最高频率个最低频率的差, 单位是Hz. 在网络中通常是数字信道所能传输的 "最高速率", 单位是 b/s.  
时延:  
为什么分组交换会发生丢包和时延?  
分组在路由器缓存中排队. 分组到达的速率远远超出输出链路容量, 分组排队,等待链路可用.  

四种分组延迟:

1. $d_{proc}$ 节点处理延迟
   1. 差错检测
   2. 确定输出链路
   3. 通常小于 msec
2. $d_{queue}$ 排队延迟
   1. 等待输出链路可用
   2. 取决于路由器的拥塞程度
3. $d_{trans}$ 传输延迟, 将所有分组推向链路的时间, $d_{trans}=L/R$
   1. L: 分组长度
   2. R: 链路带宽
4. $d_{prop}$ 传播延迟,链路的物理性质, $d_{prop}=d/s$
   1. d: 物理链路的长度
   2. s: 信号传播的速度

**排队延迟$d_{queue}$**
R: 链路带宽  
L: 分组长度  
a: 平均分组到达的速率  
如果 $La/R$~0, 平均排队延迟很小.
如果 $La/R$~1, 平均排队延迟很大.
如果 $La/R$>1, 平均排队延迟无限大.

**时延带宽积 = 传播延时$d_{prop}$*带宽.** 得到的单位是 $bit$, 又被称为以比特为单位的链路长度.

分组丢失: 当路由器的队列缓存满了, 后来到达的包就会丢失.  

吞吐量: 发送端到接收端之间传送数据速率.在实际网络中, 吞吐量主要取决于瓶颈速率, 通常是主机到交换机或者链路速率  
即时吞吐量: 给定时刻的速率  
平均吞吐量: 一段时间内的平均速率  

## 计算机网络体系结构

![分层基本概念](计算机网络学习笔记.assets/2020-11-16-17-56-16.png)  

## OSI 参考模型

![OSI](计算机网络学习笔记.assets/2020-11-16-18-03-33.png)  
![分层](计算机网络学习笔记.assets/2020-11-16-18-11-10.png)  
![数据封装](计算机网络学习笔记.assets/2020-11-16-18-16-27.png)  
![为什么要进行数据封装](计算机网络学习笔记.assets/2020-11-16-18-19-00.png)  

**物理层的功能:**

- 接口特性
  - 机械特性, 电气特性..
- 比特编码
- 数据率
- 比特同步
  - 时钟同步
- 传输模式
  - 单工通信, 半双工, 双工

**数据链路层功能:**

- 负责结点-结点数据传输  
- 组帧  
- 物理寻址: 在帧头中增加发送端/接收端的物理地址标识数据帧的发送端/接收端
- 流量控制: 避免淹没接收端, 匹配发送速度和接收速度
- 差错控制: 检测并重传损坏或者丢失帧, 避免重复帧
- 接入控制(访问控制): 在某一时刻决定哪个设备拥有链路(物理介质)控制权

**网络层功能:**

- 负责源主机到目的主机数据分组的交付  
  - 可能跨越多个网络
- 逻辑寻址
  - 全局唯一逻辑地址, 确保数据分组被送到目的主机(IP地址)
- 路由
  - 路由器互联网络, 并路由分组到最终目的主机
  - 路径转发
- 分组转发

**传输层功能:**

![传输层](计算机网络学习笔记.assets/2020-11-16-20-06-02.png)  
负责源-目的(端-端)(进程之间)间完整报文传输.  

- 报文分段,重组
- SAP寻址
  - 确保将报文提交给正确进程, 如端口号  
  ![寻址](计算机网络学习笔记.assets/2020-11-16-20-11-20.png)  
- 连接控制
- 流量控制
- 差错控制

**会话层功能:**

![会话层](计算机网络学习笔记.assets/2020-11-16-20-14-34.png)  

- 对话控制
  - 建立,维护
- 同步
  - 在数据流中插入"同步点"
- 最薄的一层

**表示层功能:**

![表示层](计算机网络学习笔记.assets/2020-11-16-20-15-43.png)  
处理两个系统间交换信息的语法和语义问题

- 数据表示转化
  - 转化为主机独立的编码, 到达之后再转化为主机相关的编码
- 加密,解密
- 压缩,解压缩

**应用层功能:**

![应用层](计算机网络学习笔记.assets/2020-11-16-20-18-58.png)  
支持用户通过用户代理或者网络接口使用网络(服务)  
典型的网络应用:

- 文件传输 FTP
- 电子邮件 SMTP
- Web HTTP...

## TCP/IP 参考模型

![tcp/ip](计算机网络学习笔记.assets/2020-11-16-20-22-53.png)  

**五层参考模型:**  
![五层参考模型](计算机网络学习笔记.assets/2020-11-16-20-25-54.png)  
五层模型的数据封装  
![数据封装](计算机网络学习笔记.assets/2020-11-16-20-29-31.png)  
